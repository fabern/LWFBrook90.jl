<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SVAT Model · LWFBrook90.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://fabern.github.io/LWFBrook90.jl/model/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="LWFBrook90.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">LWFBrook90.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">About</a></li><li class="is-active"><a class="tocitem" href>SVAT Model</a><ul class="internal"><li><a class="tocitem" href="#Description"><span>Description</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../user-guide/">User Guide</a></li><li><a class="tocitem" href="../example/">Example</a></li><li><a class="tocitem" href="../code-lst/">Code Listing</a></li><li><a class="tocitem" href="../function-docs/">Function Documentations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SVAT Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SVAT Model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/fabern/LWFBrook90.jl/blob/master/docs/src/model.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SVAT-Model"><a class="docs-heading-anchor" href="#SVAT-Model">SVAT Model</a><a id="SVAT-Model-1"></a><a class="docs-heading-anchor-permalink" href="#SVAT-Model" title="Permalink"></a></h1><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>LWFBrook90.jl is a 1D Soil-Vegetation-Atmosphere Transfer (SVAT) model, calculating the soil water balance in forest soil. Modelled processes include vertical soil water movement, soil and plant evapotranspiration and temporary storages in snowpack or interception layer.</p><p>Vertical soil water movement is modelled using the Richards equations and preferential flow. Mass loss through evaporation from temporary storages (snowpack or interception by vegetation) is included.</p><p>Processes and state variables in LWF-BROOK90 are summarised visually in Figure 1 below.</p><p align="center">
<img src='../assets/LWFBrook90jl_overview_v1.4-juliacolors.png' width="400"><br>
<br><em><b>Figure 1</b>: Summary of processes and state variables used in LWFBrook90.jl</em><br>
<p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The model is implemented based code from the R package LWFBrook90R and its Fortran source code as well as the original implementation of BROOK90 (v4.8) (www.ecoshift.net/brook/b90doc.html).</p><p>LWFBrook90.jl is 100% implemented in Julia. It defines the dynamical system in terms of ordinary differential equations and corresponding (time-varying) parameters and makes use of the package DifferentialEquations.jl for solving the evolution of the system state for a specified time <code>tspan</code> and intial conditions <code>u0</code>.</p><p>LWFBrook90.jl is developed with the following objectives in mind:</p><ul><li>[ ] support for stable isotopes (δ¹⁸O and δ²H) by including transport equation and fractionation processes</li><li>[ ] efficient parameter estimation (optimizing computational costs)</li><li>[ ] model flexibility for alternative processes parametrizations (possibly resulting in a <a href="https://presentations.copernicus.org/EGU2020/EGU2020-17975_presentation.pdf">flexible model framework</a>)</li></ul><p>Currently two mode of operation are distinguished by the flag <code>compute_intermediate_quantities = true</code>. It determines wheter additional, non-essential quantities are computed during simulation. The intent is to optimize computational cost.</p><p>LWFBrook90.jl contains two parametrizations of the soil hydraulics: Mualem-van Genuchten and Clapp-Hornberger. They can be switched by setting the parameter <code>FLAG_MualVanGen</code>.</p><h3 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h3><p>LWFBrook90.jl makes use of <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a> to solve the system of Ordinary Differential Equations (ODE). Each state variable (<code>u</code>) has a corresponding ODE. The ODEs are defined by their right hand side defined in the function <code>f</code> (which sets <code>du</code> that is the rate of change in <code>u</code>). The right hand side <code>f(u,p,t)</code> depends on time <code>t</code>, parameters <code>p</code> (time-dependent or constant), and the state <code>u</code>.</p><p>Variable naming generally follows the convention by BROOK90 and LWFBrook90R, but uses additionally a prefix to indicate their dependencies (<code>p_*</code>, <code>p_fT_*</code>, <code>p_fu_*</code> for constant, time dependent or state dependent parameters, <code>u_*</code>, <code>u_aux_*</code> for elementary and auxiliary state variables respectively, and <code>aux_du_*</code> for auxiliary rate of changes of state variables).</p><p>Note that some state variables (rain and snow interception storage, <code>u_INTR</code>, <code>u_INTS</code> and snow storage and energy <code>u_SNOW</code>, <code>u_CC</code>, <code>u_SNOWLQ</code>) are updated once per simulation day and other state variables (groundwater and soil water storages <code>u_GWAT</code>,<code>u_SWATI</code>) are solved on a higher resolved time discretization set by the ODE solver, resulting effecively in an operator splitting scheme.</p><h3 id="Implementation-roadmap"><a class="docs-heading-anchor" href="#Implementation-roadmap">Implementation roadmap</a><a id="Implementation-roadmap-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-roadmap" title="Permalink"></a></h3><p>Some ideas for future development include:</p><ul><li>include models of transport and fractionation processes</li><li>include transport processes within tree stems</li><li>test use of parameter estimation procedures (check external Julia packages)</li><li>refactor code supporting model flexibility<ul><li>distinguish Mualem-van Genuchten and Clapp-Hornberger parametrizations more cleanly and reduce redundundancy in code</li><li>split LWFBrook90 code into sub-models:<ul><li>one sub-model that precisely reproduces what LWFBrook90R did (w.r.t to adaptive time stepping, operator splitting in state variable updates and manual resetting of variables)</li><li>another sub-model that implements improved implementations of adaptive time stepping (using DiffEq.jl solution domain validity callbacks) and continuous, subdaily variable updates for all state variables</li></ul></li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« About</a><a class="docs-footer-nextpage" href="../user-guide/">User Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 18 August 2021 16:45">Wednesday 18 August 2021</span>. Using Julia version 1.8.0-DEV.365.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

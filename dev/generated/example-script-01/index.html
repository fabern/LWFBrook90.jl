<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example-01 (autogenerated) · LWFBrook90.jl</title><meta name="title" content="Example-01 (autogenerated) · LWFBrook90.jl"/><meta property="og:title" content="Example-01 (autogenerated) · LWFBrook90.jl"/><meta property="twitter:title" content="Example-01 (autogenerated) · LWFBrook90.jl"/><meta name="description" content="Documentation for LWFBrook90.jl."/><meta property="og:description" content="Documentation for LWFBrook90.jl."/><meta property="twitter:description" content="Documentation for LWFBrook90.jl."/><meta property="og:url" content="https://fabern.github.io/LWFBrook90.jl/generated/example-script-01/"/><meta property="twitter:url" content="https://fabern.github.io/LWFBrook90.jl/generated/example-script-01/"/><link rel="canonical" href="https://fabern.github.io/LWFBrook90.jl/generated/example-script-01/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="LWFBrook90.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LWFBrook90.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">About</a></li><li><a class="tocitem" href="../../model/">SVAT Model</a></li><li><a class="tocitem" href="../../user-guide/">User Guide</a></li><li class="is-active"><a class="tocitem" href>Example-01 (autogenerated)</a><ul class="internal"><li><a class="tocitem" href="#Setup-and-run-simulation"><span>Setup and run simulation</span></a></li><li><a class="tocitem" href="#Postprocessing-results"><span>Postprocessing results</span></a></li></ul></li><li><a class="tocitem" href="../../validation/">Validation</a></li><li><a class="tocitem" href="../../code-lst/">Code Listing</a></li><li><a class="tocitem" href="../../function-docs/">Function Documentations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example-01 (autogenerated)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example-01 (autogenerated)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fabern/LWFBrook90.jl/blob/develop/examples/example-script-01.jl#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-Script-01"><a class="docs-heading-anchor" href="#Example-Script-01">Example Script 01</a><a id="Example-Script-01-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Script-01" title="Permalink"></a></h1><p>This example was generated 2023-11-03</p><p>Example data from Beatenberg is located in subfolder <code>examples/</code>. WSL is acknowledged for providing the input data (see section <a href="../../#Acknowledgments">Acknowledgments</a>).</p><p>To run your own simulations: follow the step-by-step instructions below.</p><h2 id="Setup-and-run-simulation"><a class="docs-heading-anchor" href="#Setup-and-run-simulation">Setup and run simulation</a><a id="Setup-and-run-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-and-run-simulation" title="Permalink"></a></h2><pre><code class="language-julia hljs"># How to work with a Julia script in a new environment
# create a new folder: &quot;pgm&quot;
# a) start `julia` -&gt; `]` -&gt; activate . -&gt; add LWFBrook90
# b) in VSCode -&gt; click at bottom and select &quot;pgm&quot; as Julia env
# c) run the code
# alternatively right-click on the folder in VSCode
#   -&gt; Change to this Directory and Activate this environment

# Load packages:
using LWFBrook90

# `using LWFBrook90` brings the following exported functions into scope:
# - `SPAC()`
# - `DiscretizedSPAC()`
# - `discretize()`
# - `simulate!()`
# - `get_soil_()`
# - `get_aboveground()`
# - `get_δ()`,</code></pre><p>Define simulation model by reading in system definition and input data from input files. When printed, the generated SPAC model gives a summary.</p><pre><code class="language-julia hljs"># Read in input data
input_path = &quot;../../../examples/DAV2020-full/&quot;; input_prefix = &quot;DAV2020-full&quot;; # make sure to get the path correct relative to `pwd()``
# input_path = &quot;examples/DAV2020-full/&quot;; input_prefix = &quot;DAV2020-full&quot;;
# input_path = &quot;examples/isoBEAdense2010-18-reset-FALSE-input/&quot;; input_prefix = &quot;isoBEAdense2010-18-reset-FALSE&quot;;
model = loadSPAC(input_path, input_prefix; simulate_isotopes = false);
model = loadSPAC(input_path, input_prefix; simulate_isotopes = true);
model</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SPAC model:
===== DATES:===============

===== METEO FORCING:===============
GLOBRAD (MJ/m2/day): avg:  13.90, range:   1.04 to  32.40
PREC       (mm/day): avg:   2.61, range:   0.00 to  35.40
TMAX           (°C): avg:   9.00, range:  -8.90 to  26.60
TMIN           (°C): avg:  -0.79, range: -18.80 to  12.90
VAPPRES       (kPa): avg:   0.64, range:   0.11 to   1.37
WIND          (m/s): avg:   2.59, range:   0.70 to   4.90
δ18O            (‰): avg: -13.26, range: -22.60 to  -6.87
δ2H             (‰): avg: -95.98, range:-171.53 to -44.68

===== CANOPY EVOLUTION:===============
model.pars.canopy_evolution was loaded form meteoveg.csv

===== INITIAL CONDITIONS:===============
Soil   IC: soil_discretization.csv
Scalar IC: <span class="sgr1">3×6 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> u_GWAT_init_mm  u_INTS_init_mm  u_INTR_init_mm  u_SNOW_init_mm  u_CC_in</span> ⋯
     │<span class="sgr90"> Float64         Float64         Float64         Float64         Float64</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │            1.0             0.0             0.0             0.0          ⋯
   2 │          -13.0           -13.0           -13.0           -13.0
   3 │          -95.0           -95.0           -95.0           -95.0
<span class="sgr36">                                                               2 columns omitted</span>

===== MODEL PARAMETRIZATION:===============
         VXYLEM_mm =&gt;     20.0 |             RHOTP =&gt;      2.0 |                TH =&gt;     40.0 |
   DISPERSIVITY_mm =&gt;     40.0 |                NN =&gt;      2.5 |             MXKPL =&gt;     15.6 |
           LAT_DEG =&gt;     47.0 |          FRINTLAI =&gt;      0.1 |            MXRTLN =&gt;   3000.0 |
        ESLOPE_DEG =&gt;      0.0 |          FSINTLAI =&gt;      0.0 |          INITRLEN =&gt;     12.0 |
        ASPECT_DEG =&gt;      0.0 |          FRINTSAI =&gt;      0.1 |          INITRDEP =&gt;      0.2 |
               ALB =&gt;      0.2 |          FSINTSAI =&gt;      0.0 |          RGRORATE =&gt;      0.0 |
             ALBSN =&gt;      0.5 |            CINTRL =&gt;      0.1 |           RGROPER =&gt;     30.0 |
                C1 =&gt;      0.2 |            CINTRS =&gt;      0.1 |            FXYLEM =&gt;      0.5 |
                C2 =&gt;      0.5 |            CINTSL =&gt;      0.6 |             PSICR =&gt;     -1.0 |
                C3 =&gt;      0.2 |            CINTSS =&gt;      0.6 |             RTRAD =&gt;      0.3 |
            WNDRAT =&gt;      0.3 |            RSTEMP =&gt;     -0.5 |            NOOUTF =&gt;      1.0 |
             FETCH =&gt;   5000.0 |            MELFAC =&gt;      1.5 |          IDEPTH_m =&gt;      0.4 |
               Z0W =&gt;      0.0 |             CCFAC =&gt;      0.3 |          QDEPTH_m =&gt;      0.0 |
                ZW =&gt;      2.0 |            LAIMLT =&gt;      0.2 |              RSSA =&gt;    795.3 |
            MAXLAI =&gt;      3.0 |            SAIMLT =&gt;      0.5 |              RSSB =&gt;      1.0 |
  DENSEF_baseline_ =&gt;      1.0 |            GRDMLT =&gt;      0.3 |            INFEXP =&gt;      0.5 |
     SAI_baseline_ =&gt;      1.0 |            MAXLQF =&gt;      0.1 |             BYPAR =&gt;      0.0 |
  AGE_baseline_yrs =&gt;    100.0 |             KSNVP =&gt;      0.3 |             QFPAR =&gt;      1.0 |
 HEIGHT_baseline_m =&gt;     25.0 |            SNODEN =&gt;      0.3 |              QFFC =&gt;      0.0 |
            LWIDTH =&gt;      0.1 |             GLMAX =&gt;      0.0 |            IMPERV =&gt;      0.0 |
               Z0G =&gt;      0.0 |             GLMIN =&gt;      0.0 |            DSLOPE =&gt;      0.0 |
               Z0S =&gt;      0.0 |                CR =&gt;      0.5 |      LENGTH_SLOPE =&gt;    200.0 |
               LPC =&gt;      4.0 |                RM =&gt;   1000.0 |             DRAIN =&gt;      0.5 |
               CZS =&gt;      0.1 |                R5 =&gt;    287.0 |               GSC =&gt;      0.0 |
               CZR =&gt;      0.1 |              CVPD =&gt;      2.0 |               GSP =&gt;      0.0 |
                HS =&gt;      1.0 |                TL =&gt;      0.0 |                               |
                HR =&gt;     10.0 |                T1 =&gt;     10.0 |                               |
             ZMINH =&gt;      2.0 |                T2 =&gt;     30.0 |                              

===== SOIL DOMAIN:===============
Root distribution:       soil_discretization.csv
Soil layer properties:   <span class="sgr1">3×3 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> Upper_m  Lower_m  shp                                                                               </span>
     │<span class="sgr90"> Float64  Float64  MualemVa…                                                                         </span>
─────┼─────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │    0.0     -0.03  (θ from θr=0.000 to θs=0.379, Ks =  2854.9, STONEF=0.2, l=-3.3, n=1.2, α=   20.4)
   2 │   -0.03    -0.4   (θ from θr=0.000 to θs=0.379, Ks =  2854.9, STONEF=0.4, l=-3.3, n=1.2, α=   20.4)
   3 │   -0.4     -1.1   (θ from θr=0.000 to θs=0.379, Ks =  2854.9, STONEF=0.8, l=-3.3, n=1.2, α=   20.4)
Soil discretized into N=5 layers, Δz layers: (avg, min, max) = (0.220,0.030,0.400)m.
[-0.03, -0.1, -0.4, -0.8, -1.1]

===== SOLVER OPTIONS:===============
(compute_intermediate_quantities = true, simulate_isotopes = true, DTIMAX = 0.5, DSWMAX = 0.05, DPSIMAX = 0.0005)
</code></pre><p>If wanted, arguments can be supplied to modify the loaded SPAC (e.g. for parameter estimation), hence requiring less input CSVs. Warnings are output (see below) to signal to the user that existing input CSVs might be ignored.</p><pre><code class="language-julia hljs"># Read in providing arguments, requiring less CSVs
model_modified =
    loadSPAC(input_path, input_prefix;
        simulate_isotopes = true,
        Δz_thickness_m    = [fill(0.04, 5); # grid spacing (heterogenous), meter (N=21)
                             fill(0.05, 5); # write Δ in VSCode by typing \Delta and hit shift
                             fill(0.06, 5);
                             fill(0.07, 5);
                             fill(0.10, 1)],
        root_distribution = (beta = 0.98, z_rootMax_m=-0.5),
        IC_soil           = (PSIM_init_kPa = -7.0,
                            delta18O_init_permil = -9.0,
                            delta2H_init_permil = -11.0),
        canopy_evolution  = (DENSEF_rel = 100,
                             HEIGHT_rel = 100,
                             SAI_rel    = 100,
                             LAI_rel = (DOY_Bstart = 120,
                                     Bduration  = 21,
                                     DOY_Cstart = 270,
                                     Cduration  = 60,
                                     LAI_perc_BtoC = 100,
                                     LAI_perc_CtoB = 55)),
        storm_durations_h = [5.44, 5.44, 5.44, 5.44, 5.44, 5.44,
                             5.44, 5.44, 5.44, 5.44, 5.44, 5.44],
        IC_scalar         = (amount = (u_GWAT_init_mm = 1.,
                                       u_INTS_init_mm = 13.7,
                                       u_INTR_init_mm = 0.,
                                       u_SNOW_init_mm = 22.222,
                                       u_CC_init_MJ_per_m2 = 0.101010,
                                       u_SNOWLQ_init_mm =  0.),
                            d18O    = (u_GWAT_init_permil = -11.111,
                                       u_INTS_init_permil = -12.222,
                                       u_INTR_init_permil = -13.333,
                                       u_SNOW_init_permil = -14.444),
                            d2H     = (u_GWAT_init_permil = -95.111,
                                       u_INTS_init_permil = -95.222,
                                       u_INTR_init_permil = -95.333,
                                       u_SNOW_init_permil = -95.444)));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr33"><span class="sgr1">┌ Warning: </span></span>Isotopic signature of precipitation is available for the period (2020-12-16T00:00:00 - 2021-11-04T00:00:00), i.e. (days -16.0 - 307.0)
<span class="sgr33"><span class="sgr1">│ </span></span>         Whereas the other meteorologic inputs are available for (2021-01-01T00:00:00 - 2021-12-31T00:00:00), i.e. (days 0.0 - 364.0).
<span class="sgr33"><span class="sgr1">│ </span></span>         Isotopic signatures will be extrapolated with constant values before and after the available period.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_read_inputData.jl:938</span>
<span class="sgr33"><span class="sgr1">┌ Warning: </span></span>Requested to overwrite storm durations. Values in ../../../examples/DAV2020-full/DAV2020-full_meteo_storm_durations.csv are ignored.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_read_inputData.jl:687</span>
<span class="sgr33"><span class="sgr1">┌ Warning: </span></span>Received canopy_evolution in loadSPAC(), overwriting values from `meteoveg.csv`.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_read_inputData.jl:142</span>
<span class="sgr33"><span class="sgr1">┌ Warning: </span></span>Requested to overwrite initial conditions. Values in ../../../examples/DAV2020-full/DAV2020-full_initial_conditions.csv are ignored.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_read_inputData.jl:172</span>
<span class="sgr33"><span class="sgr1">┌ Warning: </span></span>loadSPAC(...; Δz_thickness_m = ...) provided. Ignoring `soil_discretization.csv`, i.e. also overwriting root distribution and initial conditions.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_read_inputData.jl:202</span>
<span class="sgr33"><span class="sgr1">┌ Warning: </span></span>Spatial domain soil discretization is larger than the provided soil horizon information. Lowest soil horizon will be extended.
<span class="sgr33"><span class="sgr1">│ </span></span>
<span class="sgr33"><span class="sgr1">│ </span></span>Lowest soil horizon from -0.4m to -1.1m will be extended down to -1.2000000000000006m.
<span class="sgr33"><span class="sgr1">└ </span></span><span class="sgr90">@ LWFBrook90 ~/work/LWFBrook90.jl/LWFBrook90.jl/src/func_discretize_soil_domain.jl:84</span></code></pre><p>Documentation can be accessed by typing: <code>?loadSPAC</code>, <code>?setup</code>, <code>?simulate!</code>, <code>?plotisotopes</code>, etc.</p><p>The objects <code>model</code> and <code>model_modified</code> are instances of a <code>SPAC()</code> (soil-plant-atmosphere continuum) and contain fully specified simulations. To run them they need to be transformed into a system of ODES (<code>setup()</code>) and solved (<code>simulate()</code>):</p><pre><code class="language-julia hljs"># Setup and run simulation
simulation     = setup(model)
simulation_mod = setup(model_modified)
# Inputs can be checked with:
# `plot_inputs(simulation)`. Note: NOT YET IMPLEMENTED

simulate!(simulation_mod)
simulate!(simulation_mod) # Run it a second time to showcase shorter runtime
# The computed solution is stored within the object.
# When using VSCode a progress bar is shown in the status bar.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>  Start of simulation at 2023-11-03T10:51:10.630.
<span class="sgr36"><span class="sgr1">└ </span></span>        Saving intermediate results (`saveat=`) between: (0.0, 365.0) days
 runtime: 22.655560 seconds (23.74 M allocations: 1.651 GiB, 6.28% gc time, 92.80% compilation time: &lt;1% of which was recompilation)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>  Time steps for solving: 9088 (9088 accepted out of 9122 total)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>  End of simulation at 2023-11-03T10:51:33.482.
<span class="sgr36"><span class="sgr1">┌ Info: </span></span>  Start of simulation at 2023-11-03T10:51:33.566.
<span class="sgr36"><span class="sgr1">└ </span></span>        Saving intermediate results (`saveat=`) between: (0.0, 365.0) days
 runtime: 1.554401 seconds (3.19 M allocations: 363.462 MiB, 8.07% gc time)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>  Time steps for solving: 9088 (9088 accepted out of 9122 total)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>  End of simulation at 2023-11-03T10:51:35.121.</code></pre><p>Notice that the very first time a model is simulated, the runtime is longer because it includes compilation. This compilation is not needed for any subsequent run.</p><h2 id="Postprocessing-results"><a class="docs-heading-anchor" href="#Postprocessing-results">Postprocessing results</a><a id="Postprocessing-results-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing-results" title="Permalink"></a></h2><p>These simulations can then be post-processed with predefined functions. Alternatively the following variables contain the simuation results for user-defined post-processing:</p><pre><code class="language-julia hljs">simulation_mod.ODESolution;
simulation_mod.ODESolution_datetime;
typeof(simulation_mod.ODESolution);
# HINT: To get these names, type `simulation_mod.` and wait for the autocomplete!</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SciMLBase.ODESolution{Float64, 2, Vector{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}}, Nothing, Nothing, Vector{Float64}, Vector{Vector{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}}}, SciMLBase.ODEProblem{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}, Tuple{Float64, Float64}, true, NamedTuple{(:p_soil, :NLAYER, :FLAG_MualVanGen, :compute_intermediate_quantities, :Reset, :p_DTP, :p_NPINT, :p_QLAYER, :p_SWATQX, :p_QFPAR, :p_SWATQF, :p_QFFC, :p_IMPERV, :p_LENGTH_SLOPE, :p_DSLOPE, :p_RHOWG, :p_DPSIMAX, :p_DRAIN, :p_DTIMAX, :p_INFRAC, :p_DSWMAX, :p_GSC, :p_GSP, :p_BYPAR, :p_LAT, :p_ESLOPE, :p_L1, :p_L2, :p_SNODEN, :p_MXRTLN, :p_MXKPL, :p_Z0S, :p_Z0G, :p_ZMINH, :p_CZS, :p_CZR, :p_HS, :p_HR, :p_LPC, :p_RTRAD, :p_FXYLEM, :p_WNDRAT, :p_FETCH, :p_Z0W, :p_ZW, :p_RSTEMP, :p_LWIDTH, :p_RHOTP, :p_NN, :p_KSNVP, :p_ALBSN, :p_ALB, :p_RSSA, :p_RSSB, :p_CCFAC, :p_MELFAC, :p_LAIMLT, :p_SAIMLT, :p_C1, :p_C2, :p_C3, :p_CR, :p_GLMIN, :p_GLMAX, :p_R5, :p_CVPD, :p_RM, :p_TL, :p_T1, :p_T2, :p_TH, :p_PSICR, :NOOUTF, :p_CVICE, :p_WTOMJ, :p_FSINTL, :p_FSINTS, :p_CINTSL, :p_CINTSS, :p_FRINTL, :p_FRINTS, :p_CINTRL, :p_CINTRS, :p_DURATN, :p_MAXLQF, :p_GRDMLT, :p_VXYLEM, :p_DISPERSIVITY, :simulate_isotopes, :row_idx_scalars, :row_idx_SWATI, :row_idx_TRANI, :row_idx_accum, :col_idx_d18O, :col_idx_d2H, :p_DOY, :p_MONTHN, :p_GLOBRAD, :p_TMAX, :p_TMIN, :p_VAPPRES, :p_WIND, :p_PREC, :p_DENSEF, :p_HEIGHT, :p_LAI, :p_SAI, :p_AGE, :p_fT_RELDEN, :p_δ18O_PREC, :p_δ2H_PREC, :REFERENCE_DATE, :p_fu_δ18O_SLFL, :p_fu_δ2H_SLFL, :p_fT_TADTM, :p_fT_TA, :p_fu_RNET, :aux_du_SMLT, :aux_du_SLVP, :p_fu_STHR, :aux_du_RSNO, :aux_du_SNVP, :aux_du_SINT, :aux_du_ISVP, :aux_du_RINT, :aux_du_IRVP, :u_SNOW_old, :du_GWFL, :du_SEEP, :aux_du_TRANI, :du_NTFLI, :aux_du_VRFLI, :aux_du_DSFLI, :aux_du_INFLI, :u_aux_WETNES, :u_aux_PSIM, :u_aux_PSITI, :u_aux_θ, :u_aux_θ_tminus1, :p_fu_KK, :aux_du_VRFLI_1st_approx, :aux_du_BYFLI, :p_fu_BYFRAC, :p_fu_SRFL, :p_fu_SLFL, :DPSIDW, :cache1, :cache2, :cache_for_ADE_28), Tuple{LWFBrook90.KPT.KPT_SOILPAR_Mvg1d{Vector{Float64}}, Int64, Bool, Bool, Bool, Float64, Int64, Int64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Vector{Float64}, Float64, Float64, Float64, Int64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Bool, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Vector{Float64}, Float64, Float64, Float64, Float64, Bool, NamedTuple{(:GWAT, :INTS, :INTR, :SNOW, :CC, :SNOWLQ, :RWU, :XYLEM), NTuple{8, Nothing}}, Nothing, Nothing, Nothing, Int64, Int64, LWFBrook90.var&quot;#103#121&quot;{SPAC}, LWFBrook90.var&quot;#104#122&quot;{SPAC}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}, Interpolations.FilledExtrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Int64}, Interpolations.FilledExtrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Int64}, Interpolations.FilledExtrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Int64}, Interpolations.FilledExtrapolation{Float64, 1, Interpolations.ScaledInterpolation{Float64, 1, Interpolations.BSplineInterpolation{Float64, 1, Vector{Float64}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Base.OneTo{Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}}, Interpolations.BSpline{Interpolations.Constant{Interpolations.Previous, Interpolations.Throw{Interpolations.OnGrid}}}, Int64}, LWFBrook90.var&quot;#132#133&quot;{DataFrames.DataFrame}, Interpolations.Extrapolation{Float64, 2, Interpolations.GriddedInterpolation{Float64, 2, Matrix{Float64}, Tuple{Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.NoInterp}, Tuple{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}, UnitRange{Int64}}}, Tuple{Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.NoInterp}, Interpolations.Flat{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Flat{Nothing}}, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Constant{Interpolations.Next, Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Flat{Nothing}}, DateTime, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, NTuple{28, Vector{Float64}}}}, SciMLBase.ODEFunction{true, SciMLBase.AutoSpecialize, typeof(LWFBrook90.f_LWFBrook90!), LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, typeof(SciMLBase.DEFAULT_OBSERVED), Nothing, Nothing}, Base.Pairs{Symbol, Any, NTuple{12, Symbol}, NamedTuple{(:callback, :progress_name, :progress, :saveat, :save_everystep, :alg, :reltol, :adaptive, :internalnorm, :unstable_check, :dt, :dtmax), Tuple{SciMLBase.CallbackSet{Tuple{}, Tuple{SciMLBase.DiscreteCallback{DiffEqCallbacks.var&quot;#62#66&quot;{Bool, Float64, Base.RefValue{Int64}, Base.RefValue{Float64}}, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_check_balance_errors!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, DiffEqCallbacks.var&quot;#63#67&quot;{Bool, DiffEqCallbacks.var&quot;#65#69&quot;{Bool}, Float64, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_check_balance_errors!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, Base.RefValue{Int64}, Base.RefValue{Float64}}, typeof(SciMLBase.FINALIZE_DEFAULT)}, SciMLBase.DiscreteCallback{DiffEqCallbacks.var&quot;#27#28&quot;, DiffEqCallbacks.FunctionCallingAffect{typeof(LWFBrook90.LWFBrook90R_updateIsotopes_GWAT_SWAT_AdvecDiff!), DataStructures.BinaryMinHeap{Float64}, Vector{Float64}}, typeof(DiffEqCallbacks.functioncalling_initialize), typeof(SciMLBase.FINALIZE_DEFAULT)}, SciMLBase.DiscreteCallback{DiffEqCallbacks.var&quot;#62#66&quot;{Bool, Float64, Base.RefValue{Int64}, Base.RefValue{Float64}}, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_updateAmounts_INTS_INTR_SNOW_CC_SNOWLQ!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, DiffEqCallbacks.var&quot;#63#67&quot;{Bool, DiffEqCallbacks.var&quot;#65#69&quot;{Bool}, Float64, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_updateAmounts_INTS_INTR_SNOW_CC_SNOWLQ!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, Base.RefValue{Int64}, Base.RefValue{Float64}}, typeof(SciMLBase.FINALIZE_DEFAULT)}, SciMLBase.DiscreteCallback{DiffEqCallbacks.var&quot;#62#66&quot;{Bool, Float64, Base.RefValue{Int64}, Base.RefValue{Float64}}, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_updateIsotopes_INTS_INTR_SNOW!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, DiffEqCallbacks.var&quot;#63#67&quot;{Bool, DiffEqCallbacks.var&quot;#65#69&quot;{Bool}, Float64, DiffEqCallbacks.PeriodicCallbackAffect{typeof(LWFBrook90.LWFBrook90R_updateIsotopes_INTS_INTR_SNOW!), Float64, Base.RefValue{Float64}, Base.RefValue{Int64}}, Base.RefValue{Int64}, Base.RefValue{Float64}}, typeof(SciMLBase.FINALIZE_DEFAULT)}}}, String, Bool, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}, Bool, OrdinaryDiffEq.Tsit5{typeof(OrdinaryDiffEq.trivial_limiter!), typeof(OrdinaryDiffEq.trivial_limiter!), Static.False}, Float64, Bool, typeof(LWFBrook90.norm_to_use), typeof(LWFBrook90.unstable_check_function), Float64, Float64}}}, SciMLBase.StandardODEProblem}, OrdinaryDiffEq.Tsit5{typeof(OrdinaryDiffEq.trivial_limiter!), typeof(OrdinaryDiffEq.trivial_limiter!), Static.False}, OrdinaryDiffEq.InterpolationData{SciMLBase.ODEFunction{true, SciMLBase.AutoSpecialize, typeof(LWFBrook90.f_LWFBrook90!), LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, typeof(SciMLBase.DEFAULT_OBSERVED), Nothing, Nothing}, Vector{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}}, Vector{Float64}, Vector{Vector{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}}}, OrdinaryDiffEq.Tsit5Cache{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}, ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}, ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(SWATI = ViewAxis(1:63, Axis(mm = 1:21, d18O = 22:42, d2H = 43:63)), GWAT = ViewAxis(64:66, Axis(mm = 1, d18O = 2, d2H = 3)), INTS = ViewAxis(67:69, Axis(mm = 1, d18O = 2, d2H = 3)), INTR = ViewAxis(70:72, Axis(mm = 1, d18O = 2, d2H = 3)), SNOW = ViewAxis(73:75, Axis(mm = 1, d18O = 2, d2H = 3)), RWU = ViewAxis(76:78, Axis(mmday = 1, d18O = 2, d2H = 3)), XYLEM = ViewAxis(79:81, Axis(mm = 1, d18O = 2, d2H = 3)), CC = ViewAxis(82:82, Axis(MJm2 = 1,)), SNOWLQ = ViewAxis(83:83, Axis(mm = 1,)), TRANI = ViewAxis(84:146, Axis(mmday = 1:21, d18O = 22:42, d2H = 43:63)), aux = ViewAxis(147:209, Axis(θ = 1:21, ψ = 22:42, K = 43:63)), accum = ViewAxis(210:240, Axis(cum_d_prec = 1, cum_d_rfal = 2, cum_d_sfal = 3, cum_d_rint = 4, cum_d_sint = 5, cum_d_rsno = 6, cum_d_rnet = 7, cum_d_smlt = 8, cum_d_evap = 9, cum_d_tran = 10, cum_d_irvp = 11, cum_d_isvp = 12, cum_d_slvp = 13, cum_d_snvp = 14, cum_d_pint = 15, cum_d_ptran = 16, cum_d_pslvp = 17, flow = 18, seep = 19, srfl = 20, slfl = 21, byfl = 22, dsfl = 23, gwfl = 24, vrfln = 25, cum_d_rthr = 26, cum_d_sthr = 27, StorageSWAT = 28, StorageWATER = 29, BALERD_SWAT = 30, BALERD_total = 31)))}}}, typeof(OrdinaryDiffEq.trivial_limiter!), typeof(OrdinaryDiffEq.trivial_limiter!), Static.False}}, SciMLBase.DEStats, Nothing}</code></pre><p><code>simulation_mod.ODESolution</code> is a ODESolution object: documentation how to access under: <code>https://docs.sciml.ai/DiffEqDocs/stable/basics/solution/</code> and more generally: <code>https://docs.sciml.ai/Overview/stable/</code> simulation<em>mod.ODESolution.t simulation</em>mod.ODESolution.u simulation<em>mod.ODESolution.retcode simulation</em>mod.ODESolution.destats</p><p>Note that it is possible to use R Code from within Julia, e.g ggplot: <code>https://stackoverflow.com/a/70073193/3915004</code></p><h3 id="Plotting-(using-provided-functions)"><a class="docs-heading-anchor" href="#Plotting-(using-provided-functions)">Plotting (using provided functions)</a><a id="Plotting-(using-provided-functions)-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-(using-provided-functions)" title="Permalink"></a></h3><p>Below an example script using the provided plot recipes that plot a) amounts, b) isotopes, or c) forcing and states as an additional internal check:</p><pre><code class="language-julia hljs">using Plots, Measures; gr();
pl1 = plotamounts(simulation_mod, :above_and_belowground, :showRWUcentroid)
pl1</code></pre><img src="c9df0409.svg" alt="Example block output"/><pre><code class="language-julia hljs">pl2 = plotisotopes(simulation_mod, :d18O, (d18O = :auto, d2H = :auto), :showRWUcentroid)
pl2</code></pre><img src="c7b75987.svg" alt="Example block output"/><pre><code class="language-julia hljs">pl3 = plotforcingandstates(simulation_mod)
pl3

# Use of additional arguments to `plotisotopes` is illustrated here.
# Note that typing `?plotisotopes` provides the documentation to the function.
# plotisotopes(simulation_mod, :d2H)
# plotisotopes(simulation_mod, :d18O)
# plotisotopes(simulation_mod;
#              xlim = (DateTime(&quot;2010-01-01&quot;), DateTime(&quot;2010-03-31&quot;)))
# plotisotopes(simulation_mod, :d2H, (d18O = :auto, d2H = :auto), :showRWUcentroid;
#              xlim = (DateTime(&quot;2010-01-01&quot;), DateTime(&quot;2010-08-30&quot;)))</code></pre><img src="4873b7c6.svg" alt="Example block output"/><p>Saving plots can be done with <code>savefig</code></p><pre><code class="language-julia hljs"># using Dates: today;
# out_dir = joinpath(&quot;gitignored&quot;,&quot;out&quot;, string(today()))
# mkpath(out_dir)

# fname = input_prefix
# savefig(pl1, joinpath(out_dir, fname*&quot;_plotRecipe_AMT.png&quot;))
# savefig(pl2, joinpath(out_dir, fname*&quot;_plotRecipe_ISO.png&quot;))
# savefig(pl3, joinpath(out_dir, fname*&quot;_plotRecipe_CHECK.png&quot;))</code></pre><h3 id="Extract-values"><a class="docs-heading-anchor" href="#Extract-values">Extract values</a><a id="Extract-values-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-values" title="Permalink"></a></h3><p>Below an illustrative code snippet  how to export certain depths into a *.csv:</p><pre><code class="language-julia hljs">using CSV, DataFrames

# How to get θ?
get_soil_(:θ, simulation_mod;
    depths_to_read_out_mm = nothing, days_to_read_out_d = nothing)
depth_to_read_out_mm = [10, 150, 500, 1000, 1150]
get_soil_(:θ, simulation_mod;
    depths_to_read_out_mm = depth_to_read_out_mm, days_to_read_out_d = nothing)
get_soil_(:θ, simulation_mod;
    depths_to_read_out_mm = depth_to_read_out_mm)

# How to export θ as CSV?
# Only every day, provide days_to_read_out
days_to_read_out = range(simulation_mod.ODESolution.prob.tspan...)
dates_to_read_out = LWFBrook90.RelativeDaysFloat2DateTime.(
    days_to_read_out, simulation_mod.parametrizedSPAC.reference_date)
df_out_daily = get_soil_(:θ, simulation_mod;
    depths_to_read_out_mm = depth_to_read_out_mm, days_to_read_out_d = days_to_read_out)

insertcols!(df_out_daily, 1, :dates =&gt; dates_to_read_out);
show(df_out_daily)
##plot(df_out_daily[:,:dates], Matrix(df_out_daily[:,Not([:dates, :time])]))
##CSV.write(
#    joinpath(out_dir, fname * &quot;_θ_depths_daily.csv&quot;),
#    df_out_daily)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">366×7 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> dates                time     θ_10mm    θ_150mm   θ_500mm   θ_1000mm  θ</span> ⋯
     │<span class="sgr90"> DateTime             Float64  Float64   Float64   Float64   Float64   F</span> ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2021-01-01T00:00:00      0.0  0.200587  0.200587  0.200587  0.200587  0 ⋯
   2 │ 2021-01-02T00:00:00      1.0  0.195189  0.199116  0.203679  0.2013    0
   3 │ 2021-01-03T00:00:00      2.0  0.19362   0.197972  0.205324  0.202463  0
   4 │ 2021-01-04T00:00:00      3.0  0.192807  0.197298  0.206038  0.203769  0
   5 │ 2021-01-05T00:00:00      4.0  0.192393  0.19691   0.20635   0.205124  0 ⋯
   6 │ 2021-01-06T00:00:00      5.0  0.192124  0.196648  0.206501  0.206435  0
   7 │ 2021-01-07T00:00:00      6.0  0.192024  0.196533  0.206607  0.207652  0
   8 │ 2021-01-08T00:00:00      7.0  0.191919  0.196427  0.206691  0.208756  0
  ⋮  │          ⋮              ⋮        ⋮         ⋮         ⋮         ⋮        ⋱
 360 │ 2021-12-26T00:00:00    359.0  0.192669  0.197482  0.210105  0.221148  0 ⋯
 361 │ 2021-12-27T00:00:00    360.0  0.19261   0.1974    0.209935  0.220924  0
 362 │ 2021-12-28T00:00:00    361.0  0.192623  0.197387  0.209798  0.220705  0
 363 │ 2021-12-29T00:00:00    362.0  0.192725  0.19746   0.209726  0.220495  0
 364 │ 2021-12-30T00:00:00    363.0  0.280244  0.284455  0.244632  0.220354  0 ⋯
 365 │ 2021-12-31T00:00:00    364.0  0.25555   0.267545  0.302739  0.22528   0
 366 │ 2022-01-01T00:00:00    365.0  0.245386  0.257208  0.295146  0.279607  0
<span class="sgr36">                                                   1 column and 351 rows omitted</span></code></pre><pre><code class="language-julia hljs"># # ### Plotting (using your own functions)
# # Below an example script using the manually written code to plot the simulation_mod.#

# # Resulting plot of some aboveground quantities:
# pl_ab_3 = plot(simulation_mod.ODESolution; vars = [2, 3, 4],
#     label=[&quot;INTS (mm)&quot; &quot;INTR (mm)&quot; &quot;SNOW (mm)&quot;])
# plot!(pl_ab_3,
#         [ref_aboveground.intr,
#         ref_aboveground.ints,
#         ref_aboveground.snow], label = &quot;LWFBrook90R&quot;, line = :dash, color = :black)#

# # Resulting plot of other aboveground quantities:
# pl_ab_4 = plot(simulation_mod.ODESolution; vars = [2, 3],
#     label=[&quot;INTS (mm)&quot; &quot;INTR (mm)&quot;])
# plot!(pl_ab_4,
#         [ref_aboveground.intr,
#         ref_aboveground.ints], label = &quot;LWFBrook90R&quot;, line = :dash, color = :black)


# # Belowground quantities (θ,ψ,δ of soil water)
# PREC_color = :black
# depth_to_read_out_mm = [150, 500, 800, 1500]
# if true # simulate_isotopes
#     df_δsoil = get_soil_([:δ18O, :δ2H],
#         example_result; depths_to_read_out_mm = depth_to_read_out_mm)
#     δ_results = get_δ(simulation_mod)
# end
#
# timepoints = simulation_mod.ODESolution_datetime
# df_θψ = get_soil_([:θ, :ψ],
#     simulation_mod, depths_to_read_out_mm = depth_to_read_out_mm)
#
# pl_θ = plot(timepoints, #df_θψ.time,
#     Matrix(select(df_θψ, r&quot;θ_&quot;)),
#     labels = permutedims(names(select(df_θψ, r&quot;θ_&quot;))),
#     xlabel = &quot;Date&quot;,
#     ylabel = &quot;θ\n[-]&quot;,
#     legend = :outerright)
# pl_ψ = plot(timepoints, #df_θψ.time,
#     ## -Matrix(select(df_θψ, r&quot;ψ_&quot;)),
#     Matrix(select(df_θψ, r&quot;ψ_&quot;)),
#     labels = permutedims(names(select(df_θψ, r&quot;ψ_&quot;))),
#     xlabel = &quot;Date&quot;,
#     ylabel = &quot;ψ\n[kPa]&quot;,
#     legend = :outerright);</code></pre><pre><code class="language-julia hljs"># if simulate_isotopes
#     pl_δ18O = plot(simulation_mod.ODESolution_datetime,
#         Matrix(select(df_δsoil, r&quot;δ18O_&quot;)),
#         labels = permutedims(names(select(df_δsoil, r&quot;δ18O_&quot;))),
#         xlabel = &quot;Date&quot;,
#         ylabel = &quot;δ¹⁸O soil\n[‰]&quot;,
#         legend = :outerright);
#     pl_δ2H = plot(simulation_mod.ODESolution_datetime,
#         Matrix(select(df_δsoil, r&quot;δ2H_&quot;)),
#         labels = permutedims(names(select(df_δsoil, r&quot;δ2H_&quot;))),
#         xlabel = &quot;Date&quot;,
#         ylabel = &quot;δ²H soil\n[‰]&quot;,
#         legend = :outerright);
#     ## add precipitation to soil δ
#     plot!(pl_δ2H,
#         simulation_mod.ODESolution_datetime,
#         δ_results.PREC_d2H, labels = &quot;PREC&quot;, color = PREC_color, linestyle = :dot);
#     plot!(pl_δ18O,
#         simulation_mod.ODESolution_datetime,
#         δ_results.PREC_d18O, labels = &quot;PREC&quot;, color = PREC_color, linestyle = :dot);
# else
#     pl_δ18O = plot();
#     pl_δ2H = plot();
# end
#
#
#
# pl_PREC = plot(
#     simulation_mod.ODESolution_datetime,
#     simulation_mod.ODESolution.prob.p.p_PREC.(simulation_mod.ODESolution.t),
#     t = :bar, color=PREC_color,
#     legend = :outerright, labels = &quot;PREC    &quot;, # whitespace for hardcoded alignment of legend
#     ylabel = &quot;PREC\n[mm]&quot;);
# plot(plot(pl_PREC, xlab = &quot;&quot;, xticks = :none, topmargin = 5mm, bottommargin = 0mm),
#     plot(pl_θ;     xlab = &quot;&quot;, xticks = :none, topmargin = 0mm, bottommargin = 0mm),
#     plot(pl_ψ;     xlab = &quot;&quot;, xticks = :none, topmargin = 0mm, bottommargin = 0mm),
#     plot(pl_δ18O;  xlab = &quot;&quot;, xticks = :none, topmargin = 0mm, bottommargin = 0mm),
#     plot(pl_δ2H;   xtick_direction=:out     , topmargin = 0mm, bottommargin = 5mm),
#     link = :x,
#     layout = grid(5, 1, heights=[0.1, 0.25 ,0.25, 0.2, 0.2]),
#     size=(600,500), dpi = 300, margin = 5mm)</code></pre><p>####################</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../user-guide/">« User Guide</a><a class="docs-footer-nextpage" href="../../validation/">Validation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 3 November 2023 10:56">Friday 3 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
